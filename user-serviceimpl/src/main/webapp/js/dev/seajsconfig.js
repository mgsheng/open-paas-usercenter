define("page/account",["module/modal.js","module/upload.js","module/ext_validator.js","module/selectArea.js"],function(e,t,n){$(function(){var t=e("module/modal.js"),n=e("module/upload.js"),r=e("module/ext_validator.js"),i=e("module/selectArea.js"),s=$("#account_form"),o=$("#account_submit"),u=$("#agreement"),a=$("#tab_account"),f=$("#account_state"),l=$(".page-state-txt");a.addClass("active").parent().show(),i.init({container:".select-area"}),function(){var t=["\u4fe1\u606f\u5ba1\u6838\u4e2d\u3002","\u4fe1\u606f\u5df2\u901a\u8fc7\u5ba1\u6838\uff0c\u5982\u9700\u4fee\u6539\u8bf7\u53d1\u9001\u90ae\u4ef6\u5230opengame@360.cn\u3002","\u4fe1\u606f\u672a\u901a\u8fc7\u5ba1\u6838\uff0c\u8bf7\u586b\u5199\u6b63\u786e\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u91cd\u65b0\u63d0\u4ea4\u5ba1\u6838\u3002","\u4fe1\u606f\u5df2\u7b7e\u8ba2\u5408\u540c\uff0c\u4e0d\u53ef\u4fee\u6539"],r=f.data("state");l.text(t[r]);if(r==2||r==0){var i=n.uploader({pick:"#upload_tax"});i.on("uploadSuccess",function(e,t){var n=t;$("#tax_img").attr("src",n.data.URL[0]),$("#tax_url_input").val(n.data.URL[0]).trigger("change").trigger("blur").trigger("focusout")})}else $("#upload_tax").remove(),$(".form-action").remove(),$("#form-agreement").remove(),$("form").find("input,select,radio,checkbox,button").addClass("disabled").prop("disabled",!0)}(),u.on("change",function(){var e=this.checked;e?o.removeAttr("disabled").removeClass("disabled"):o.attr("disabled",!0).addClass("disabled")}),u.prop("checked")&&o.removeAttr("disabled").removeClass("disabled"),s.validate({rules:{name:"required",licence:"required",licence_number:{required:!0,rangelength:[15,15]},reg_city:"required",reg_address:"required",contacts:"required",email:{required:!0,email:!0},address_city:"required",address:"required",phone:{required:!0,phone:!0},mobile:{required:!0,mobile:!0}}})})});define("page/ad/ad_list",["module/upload.js"],function(e,t,n){$(document).ready(function(){function o(e){var t=e.next().find(".select_ad_date").val();t=t.replace(/-/g,"");if(!t){t=(new Date).toLocaleDateString();var n=t.split("/");n[1]<10&&(n[1]="0"+n[1]),n[2]<10&&(n[2]="0"+n[2]),t=n.join(""),e.next().find(".select_ad_date").val(n.join("-"))}$.ajax({url:"/update_chart?id="+e.attr("rowid")+"&date="+t,type:"post",dataType:"json"}).done(function(t){if(!t.errno){var n=t.data.data||[],r,i,s=[],o=[],u=[];if(t.data.total){var a=t.data.total,f=a.totalappear?a.totalappear:0,l=a.totalclick?a.totalclick:0,c=a.totalcost?a.totalcost:0;e.next().find(".appear_sum").text(f),e.next().find(".click_sum").text(l),e.next().find(".cost_sum").text(c/100);for(r=0,i=n.length;r<i;r++)s.push(n[r].click),o.push(n[r].appear),u.push(n[r].time.slice(0,5))}}var h={tooltip:{trigger:"axis"},legend:{data:["\u70b9\u51fb\u91cf","\u66dd\u5149\u91cf"]},toolbox:{show:!0,feature:{dataView:{show:!1,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",boundaryGap:!1,data:u}],yAxis:[{type:"value",name:"\u70b9\u51fb\u91cf",axisLabel:{formatter:"{value}\u6b21"}},{type:"value",name:"\u66dd\u5149\u91cf",axisLabel:{formatter:"{value}\u6b21"}}],series:[{name:"\u70b9\u51fb\u91cf",type:"line",data:s,symbol:"none",itemStyle:{normal:{areaStyle:{type:"default"}}}},{name:"\u66dd\u5149\u91cf",type:"line",data:o,symbol:"none",itemStyle:{normal:{areaStyle:{type:"default"}}}}]},p=[],d=$(".charts");for(var v=0;v<d.length;v++)p[v]=echarts.init(d[v]),p[v].setOption(h)})}function u(){var e=$(".newad-cntwrap");e.find('input:not(:radio)[name!=""][name!="url"][myname!="price"]').val(""),e.find("input:radio").prop("checked",!1),e.find(".newad-form-gname").html(""),e.find(".img1, .img2, .newad-upload-input textarea").val(),e.find(".status").html("\u672a\u4e0a\u4f20"),e.find(".img_view").removeAttr("href"),e.find('span[ class$="show" ]').html(""),e.find('div[ class$="show" ] img').removeAttr("src"),e.find(".newad-addetail-wrapper").closest("tr").hide()}function a(){var e=$(".ad-content"),t=$('<div class="newad-cover"></div>').appendTo(".ad-content-wrapper"),n=$(".newad-dialog"),r=n.width(),i=/newad-nowstep(\d)/g,s=$(".newad-cntwrap");n.css("right",-r+"px"),n.show().animate({right:"10px"}),s.attr("class",s.attr("class").replace(i,"newad-nowstep1"))}function h(){var e=$(".adplan-list-search"),t=$(".adplan-list-table thead select");window.location.href="/list_adplan?"+e.attr("name")+"="+e.val()+"&"+t.attr("name")+"="+t.find("option:selected").val()}function p(){var e=$(".ad-list-control input"),t=$(".adplan-detail-list thead select"),n="/list_adplan_detail?plan="+$(".ad-planname").attr("planid"),r;$.each(e,function(e,t){r=$(t),n+="&"+r.attr("name")+"="+r.val()}),$.each(t,function(e,t){r=$(t),n+="&"+r.attr("name")+"="+r.find("option:selected").val()}),window.location.href=n}function d(e){var t=e.replace(/-/g,"/"),n=new Date(t);return n.getTime().toString().substr(0,10)}function v(e){if(!e)return;$.layer({area:["auto","auto"],dialog:{msg:e.msg,btns:e.btns||2,type:e.type||4,btn:e.buttoms||["\u786e\u5b9a","\u53d6\u6d88"],yes:function(){var t=e.yesFunction;t&&typeof t=="function"&&t()},no:function(){var t=e.noFunction;t&&typeof t=="function"&&t()}}})}function m(e){e&&layer.alert(e)}function g(e){var t=e.timeout||1e3,n=e.backFunction;e.msg&&layer.msg(e.msg,t/1e3,e.icon||-1),n&&typeof n=="function"&&setTimeout(n,t)}function y(e,t){var n=e,r=t,i=new Date(e.replace("-","/").replace("-","/")),s=new Date(t.replace("-","/").replace("-","/"));return s<i?!1:!0}var t=e("module/upload.js");$("a.ad-addplanbtn").on("click",function(e){e.preventDefault();var t,n=$(".ad-newplan");n.find("input:text").val(""),$.ajax({url:"/adplan?op=add",type:"post",dataType:"json"}).done(function(e){t=$.layer({type:1,title:!1,fix:!1,border:[0],closeBtn:[0],area:["610px","370px"],page:{dom:".ad-newplan"}});var n='<option value="-1">\u8bf7\u9009\u62e9\u6e38\u620f</option>';$.each(e,function(e,t){n+="<option value="+e+">"+t+"</option>"}),$(".ad-newplan select").html(n)}),$(".newplan-form-closebtn a,.newplan-form-cancelbtn").on("click",function(e){e.preventDefault(),layer.close(t)})}),$(".ad-newplan form").validate({onclick:!1,onfocusout:function(e){var t=$(e);t.is("select")&&t.val()!="-1"?(t.removeClass("ad_error"),t.closest(".form-input").find("em.ad_error").hide()):$(e).valid()},rules:{adplanname:"required",gkey:{min:0},limitcost:{required:!0,number:!0}},messages:{adplanname:{required:'<i class="error"></i> \u8bf7\u8f93\u5165\u8ba1\u5212\u540d\u79f0'},gkey:{min:'<i class="error"></i> \u8bf7\u9009\u62e9\u6e38\u620f'},limitcost:{required:'<i class="error"></i> \u8bf7\u8f93\u5165\u6bcf\u65e5\u9650\u989d',number:'<i class="error"></i> \u8bf7\u8f93\u5165\u6b63\u786e\u7684\u91d1\u989d'}},errorClass:"ad_error",errorElement:"em"});var n=$(".newad-dialog form").validate({onfocusout:function(e){var t=$(e);t.is(":hidden")||t.valid()},rules:{adname:"required",plan:{min:0},starttime:{required:!0},stoptime:{required:!0}},messages:{plan:{min:'<i class="mgs error"></i> \u8bf7\u9009\u62e9\u63a8\u5e7f\u8ba1\u5212'},adname:{required:'<i class="mgs error"></i> \u8bf7\u8f93\u5165\u5e7f\u544a\u540d\u79f0'},starttime:{required:'<i class="mgs error"></i> \u8bf7\u8f93\u5165\u5f00\u59cb\u65f6\u95f4'},stoptime:{required:'<i class="mgs error"></i> \u8bf7\u8f93\u5165\u7ed3\u675f\u65f6\u95f4'}},errorPlacement:function(e,t){var n=t.parent(),r=$(t);r.attr("onfocus")?n.find("em.ad_error").length==0&&e.appendTo(n):e.appendTo(n)},errorClass:"ad_error",errorElement:"em"}),r=!1;$(".newplan-form-submitbtn").on("click",function(e){e.preventDefault();if(r)return;r=!0;var t=$(this);_form=t.closest("form"),_form.find("input, select").blur(),_form.find("input.ad_error, select.ad_error").length==0&&$.ajax({url:"/adplan?op=add&"+$(this).closest("form").serialize(),type:"post",dataType:"json"}).done(function(e){$(".newplan-form-cancelbtn").click(),g({msg:e?"\u65b0\u589e\u6210\u529f":"\u64cd\u4f5c\u5931\u8d25",icon:e?1:3,backFunction:function(){location.reload()}})}),r=!1}),$(".changeinput input").on("focus",function(){var e=$(this);e.attr("orivalue",e.val()).css("border","1px solid #000")}),$(".changeinput input").on("blur",function(){$(this).css("border","1px solid #fff")}),$(".changeinput input").on("change",function(){var e=$(this),t=e.val(),n=e.attr("orivalue"),r=e.closest("tr"),i=e.closest("td").hasClass("ad-list-limitcostarea"),s=i?"\u8ba1\u5212 \u201c"+r.find(".adplan-gkeyarea").html()+"\u201d \u7684\u9650\u989d":"\u5e7f\u544a \u201c"+r.find(".ad-list-adnamearea").html()+"\u201d \u7684\u51fa\u4ef7",o=i?"/list_update_limitcost?plan="+r.attr("rowid")+"&limitcost=":"/ad_fix?op=editprice&adid="+r.attr("rowid")+"&price=";t=t.replace(/[^\d.]/g,"").replace(/\.{2,}/g,"."),/^\./g.test(t)?t="0"+t:t==""&&(t="0"),t=parseFloat(t).toFixed(2),e.val(t),v({msg:"\u786e\u5b9a\u5c06"+s+"\u4fee\u6539\u4e3a\uff1a"+t+"\u5143\uff1f",yesFunction:function(){$.ajax({url:o+t,type:"post",dataType:"json"}).done(function(e){g({msg:e?"\u4fee\u6539\u6210\u529f":"\u64cd\u4f5c\u5931\u8d25",icon:e?1:3,backFunction:function(){location.reload()}})})},noFunction:function(){e.val(n)}})}),$(".ad-list-activearea select").on("focus",function(e){var t=$(this);t.attr("orivalue",t.find("option:selected").val())}),$(".ad-list-activearea select").on("change",function(e){var t=$(this),n=t.closest("tr"),r=t.find("option:selected");v({msg:"\u786e\u5b9a\u5c06\u5e7f\u544a \u201c"+n.find(".ad-list-adnamearea").html()+"\u201d \u7684\u72b6\u6001\u4fee\u6539\u4e3a\uff1a"+r.text()+"\uff1f",yesFunction:function(){$.ajax({url:"/ad_fix?op=editactive&adid="+n.attr("rowid")+"&active="+r.val(),type:"post",dataType:"json"}).done(function(e){g({msg:e?"\u4fee\u6539\u6210\u529f":"\u64cd\u4f5c\u5931\u8d25",icon:e?1:3,backFunction:function(){location.reload()}})})},noFunction:function(){t.find('option[value="'+t.attr("orivalue")+'"]').prop("selected","selected")}})});var i,s=3e5;$(".adplan-detail-list tbody tr:not( .ad-list-addetail )").on("click",function(e){e.stopPropagation(),window.clearInterval(i);var t=$(e.target),n=t.prop("type");if(t.is("input")||t.is("select")||t.is("a"))return;var r=t.closest("tr"),u=r.next(),a=r.attr("rowid");u.length>0&&($(".ad-list-addetail").stop().fadeOut().hide(),u.stop().fadeIn(function(){window.setTimeout(function(){o(r),i=window.setInterval(function(){o(r)},s)},300)}))}),$(".select_ad_date").on("focus",function(){var e=this;WdatePicker({dateFmt:"yyyy-MM-dd",onpicked:function(){o($(e).closest("tr").prev())}})}),$(".ad-list-edit").on("click",function(e){e.preventDefault(),u();var t=$(this),n=t.closest("tr").attr("rowid");$.ajax({url:"/edit_ad_detail?id="+n,type:"post",dataType:"json"}).done(function(e){if(e.length==1){var t=e[0],n=$('.newad-list-adtitle input:radio[value="'+t.pos+'"]'),r=n.closest("tr").next(),i,s;n.click(),$(".newad-form-id").val(t.id),$(".ad-modulename h1").html("\u7f16\u8f91\u5e7f\u544a"),$(".newad-form-plan").hide(),$(".newad-form-planname").show().html(t.adplanname),$(".newad-form-gname").html(t.gname);for(var o in t)$('.newad-cntwrap input:not( :radio )[name="'+o+'"]').val(t[o]),$(".newad-form-"+o+"show").html(t[o]);$('.newad-cntwrap input[name="price"]').val(t.price/100),$(".newad-form-priceshow").val(t.price/100),t["text"]!=""&&(r.find("textarea").val(t.text),$(".newad-form-textshow").html(t.text)),t["text"]!=""&&(r.find(".pricecla").val(t.price),$(".newad-form-priceshow").html(t.price)),t["image"]!=""&&(i=r.find(".img1"),s=i.closest(".newad-uploadarea"),i.val(t.image),s.find(".status").html("\u5df2\u4e0a\u4f20"),s.find(".img_view a").attr("href",t.image),$(".newad-form-image1show img").attr("src",t.image)),t["smallimage"]!=""&&(i=r.find(".img2"),s=i.closest(".newad-uploadarea"),i.val(t.smallimage),s.find(".status").html("\u5df2\u4e0a\u4f20"),s.find(".img_view a").attr("href",t.smallimage),$(".newad-form-image2show img").attr("src",t.smallimage)),a()}else g({msg:"\u8be5\u5e7f\u544a\u4e0d\u53ef\u7f16\u8f91"})})}),$(".ad-planstate a").on("click",function(e){e.preventDefault();var t=$(e.target),n=t.attr("class").indexOf("on")>0,r="/list_updateaction?active="+(n?0:1)+"&plan="+$(".ad-planname").attr("planid");v({msg:"\u786e\u5b9a\u5c06\u63a8\u5e7f\u8ba1\u5212 \u201c"+$(".ad-planname").html()+"\u201d \u7684\u72b6\u6001\u4fee\u6539\u4e3a\uff1a"+(n?"\u7981\u7528":"\u542f\u52a8")+"\uff1f",yesFunction:function(){$.ajax({url:r,type:"post",dataType:"json"}).done(function(e){var t="";e?t=n?"\u7981\u7528\u6210\u529f":"\u542f\u52a8\u6210\u529f":t="\u64cd\u4f5c\u5931\u8d25",g({msg:t,icon:e?1:3,backFunction:function(){location.reload()}})})}})}),$(".ad-list-checkbox input:checkbox").on("click",function(e){var t=$(e.target),n=$(".ad-list-table tbody input:checkbox");n.prop("checked",t.prop("checked"))}),$(".ad-list-table tbody input:checkbox").on("click",function(e){var t=$(e.target),n=$(".ad-list-table tbody input:checked"),r=$(".ad-list-table tbody tr:not( .ad-list-addetail )"),i=$(".ad-list-checkbox input:checkbox");i.prop("checked",n.length==r.length)}),$(".ad-list-control .ad-list-deletebtn").on("click",function(e){e.preventDefault();var t=[],n=$(".ad-list-table tbody input:checked").closest("tr");if(n.length==0)return;v({msg:"\u786e\u5b9a\u5220\u9664\u9009\u4e2d\u7684 "+n.length+"\u6761 \u5e7f\u544a\u6570\u636e\u5417\uff1f",yesFunction:function(){$.each(n,function(e,n){t.push($(n).attr("rowid"))}),$.ajax({type:"post",url:"/list_deletead",data:{ids:t},dataType:"json",success:function(e){g({msg:e.msg,icon:e.resno?1:3,backFunction:function(){location.reload()}})}})}})}),$(".ad-newad-wrapper a").on("click",function(e){e.preventDefault(),u(),$.ajax({url:"/ad_fix?op=add",type:"post",dataType:"json"}).done(function(e){$(".ad-modulename h1").html("\u521b\u5efa\u5e7f\u544a");var t='<option value="-1">\u8bf7\u9009\u62e9\u63a8\u5e7f\u8ba1\u5212</option>',n=$(".ad-planname").attr("planid")||null;$.each(e.adplans,function(e,n){t+='<option data-gkey="'+n.gkey+'" value="'+n.id+'" gname="'+n.gname+'">'+n.adplanname+"</option>"}),$(".newad-form-plan").html(t),n&&$(".newad-form-plan").find('option[value="'+n+'"]').attr("selected","true").end().trigger("change"),a()})}),$(".newad-step-2 .area-switcher").click(function(e){$(".newad-step-2 .newad-list-table").hide(),$(".newad-step-2 .area-switcher").removeClass("on"),$(e.target).next(".newad-list-table").show(),$(e.target).addClass("on")}),$(".newad-closebtn a").on("click",function(e){e.preventDefault();var t=$(".newad-dialog"),n=t.width();t.animate({right:-n+"px"},function(){$("div.newad-cover").remove(),t.hide()})}),$(".newad-form-plan").on("change",function(e){var t=$(e.target).find("option:selected"),n=t.attr("gname")||"";$(".newad-form-planshow").html(t.text()),$(".newad-form-gname").html(n),$(".newad-form-gnameshow").html(n),$(".newad-upload-input").find("textarea").val(n);var r="http://open.wan.360.cn/",i=t.data("gkey");$(".newad-form-url").val(r+i)}),$(".newad-step-1 input").on("change",function(e){var t=$(e.target);$("."+t.attr("show")).html(t.val())}),$(".newad-list-table .newad-list-adtitle").on("click",function(e){e.stopPropagation();var t=$(e.target),n=t.closest("tr");n.find('input:radio[name="pos"]').click()}),$(".newad-list-table input:radio").on("click",function(e){e.stopPropagation();var t=$(e.target),n=t.closest("tr"),r=n.next(),i=r.attr("postype"),s=r.attr("possize");_posPrice=r.attr("posprice"),$(".newad-console").hide(),r.length>0&&($(".newad-list-addetail").stop().fadeOut().hide(),r.stop().fadeIn().show()),$(".newad-form-possize").html(s),$(".newad-form-posprice").html(_posPrice),$(".newad-form-posdesc").html(r.find(".newad-addetail-imgdesc").html());var o=r.find(".img1").val(),u=r.find(".img2").val(),a=r.find(".newad-upload-input textarea").val(),f=r.find(".newad-upload-input .pricecla").val();$(".newad-form-img1").val(""),$(".newad-form-image1show").hide(),$(".newad-form-image1show img").attr("src",""),$(".newad-form-img2").val(""),$(".newad-form-image2show").hide(),$(".newad-form-image2show img").attr("src",""),$(".newad-form-text").val(a),$(".newad-form-textshow").html(a),$(".newad-form-price").val(f),$(".newad-form-priceshow").html(f),i>0&&($(".newad-form-image1show").show(),$(".newad-form-image1show img").attr("src",o),$(".newad-form-img1").val(o)),i>1&&($(".newad-form-image2show").show(),$(".newad-form-image2show img").attr("src",u),$(".newad-form-img2").val(u)),i!="0"&&(i=="1"?($(".newad-form-image2show").hide(),$(".newad-form-img1").val(r.find(".img1").val()),$(".newad-form-img2").val(r.find(".img2").val())):i=="2"&&($(".newad-form-image1show").show(),$(".newad-form-image2show").show()))}),$(".newad-list-addetail textarea").on("change",function(e){var t=$(e.target),n=t.val();$(".newad-form-textshow").html(n),$(".newad-form-text").val(n)}),$(".newad-list-addetail .pricecla").on("change",function(e){var t=$(e.target),n=t.val();$(".newad-form-priceshow").html(n),$(".newad-form-price").val(n)});var f={};$("[id$='type-upload']").each(function(e,n){console.log(n.id),f[n.id]=t.uploader({pick:"#"+n.id}),f[n.id].on("uploadSuccess",function(e,t){var r=t,i=$("#"+n.id).closest(".newad-uploadarea"),s=r.data.URL[0],o=i.attr("imgType");i.find("span.status").text("\u5df2\u4e0a\u4f20"),i.find(".img_view").addClass("font-blue").find("a").attr("href",s),o=="1"?($(".newad-form-img1").val(s),$(".newad-form-image1show img").css({width:i.attr("imgwidth")+"px",height:i.attr("imgheight")+"px"}).attr("src",s),i.find(".img1").val(s)):o=="2"&&($(".newad-form-img2").val(s),$(".newad-form-image2show img").css({width:i.attr("imgwidth")+"px",height:i.attr("imgheight")+"px"}).attr("src",s),i.find(".img2").val(s))})});var l=!1;$(".newad-controlbar .newad-nextstep").on("click",function(e){e.preventDefault();if(l)return;var t=/newad-nowstep(\d)/g,n=$(".newad-cntwrap"),r=t.exec(n.attr("class"))[1],i=!1;l=!0,$(".newad-console").hide();if(r=="1"){var s=$(".newad-step-1").find("select, input:not(:hidden)").blur().end().find("select.ad_error, input.ad_error").length;s==0&&(i=!0),l=!1,i&&n.removeClass("newad-nowstep"+parseInt(r)).addClass("newad-nowstep"+(parseInt(r)+1))}else if(r=="2"){var o=$(".newad-step-2 input:checked").length;if(o==0)$(".newad-console").html("\u8bf7\u9009\u62e9\u4e00\u9879\u5e7f\u544a\u89c4\u683c\uff0c\u7136\u540e\u7ee7\u7eed").show();else if(o==1){var u=$(".newad-step-2 input:checked"),a=u.closest("tr").next(),f=a.find(".newad-upload-input>input, textarea"),c,h=!0,p=!0;$.each(f,function(e,t){c=$(t);if(c.val()==""){h=!1;return}}),_priceitems=a.find(".newad-upload-input>.pricecla"),$.each(_priceitems,function(e,t){c=$(t);if(c.val()==""||!/^(0|[1-9][0-9]{0,9})(\.[0-9]{1,2})?$/.test(c.val())){p=!1;return}});if(!p)$(".newad-console").html("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4ef7\u683c").show();else if(!h)$(".newad-console").html("\u8bf7\u5b8c\u6210\u9009\u4e2d\u5e7f\u544a\u89c4\u683c\u7684\u5e7f\u544a\u7d20\u6750\u4e0a\u4f20\uff0c\u7136\u540e\u7ee7\u7eed").show();else{var d="/check_update?id="+u.val()+"&postype="+a.attr("postype");$.each(f,function(e,t){c=$(t),d+="&"+c.attr("datatype")+"="+c.val()}),$.ajax({url:d,type:"post",dataType:"json"}).done(function(e){e?i=!0:$(".newad-console").html("\u4e0a\u4f20\u7d20\u6750\u89c4\u683c\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\uff0c\u7136\u540e\u7ee7\u7eed").show(),l=!1,i&&n.removeClass("newad-nowstep"+parseInt(r)).addClass("newad-nowstep"+(parseInt(r)+1))})}}}});var c=!1;$(".newad-controlbar .newad-submit").on("click",function(e){e.preventDefault();if(c)return;var t=$(this),n=t.closest("form").serialize(),r=$(".newad-form-id").val()=="",i=r?"\u6dfb\u52a0":"\u4fee\u6539",s="/ad_fix?op="+(r?"add":"edit")+"&";c=!0,$.ajax({url:s+n,type:"post",dataType:"json",success:function(e){$(".newad-closebtn a").click(),g({msg:i+(e.errno?"\u6dfb\u52a0\u5931\u8d25":"\u6210\u529f"),icon:e.errno?3:1,backFunction:function(){location.reload()}})}}),c=!1}),$(".adplan-list-table thead select").on("change",h),$(".adplan-list-searchbtn").on("click",h),$(".adplan-detail-list thead select").on("change",p),$(".ad-list-searchbtn").on("click",p),$("input.Wdate").on("blur",function(e){var t=$(this),n=t.val(),r=t.prev(".Wdate"),i=t.next(".Wdate");if(n=="")return;var s=d(n);if(r.length>0&&r.val()!=""){var o=d(r.val());s<o&&t.val("")}else if(i.length>0&&i.val()!=""){var u=d(i.val());s>u&&t.val("")}}),$(".js-list-table").on("focus",".js-list-wdate",function(e){var t=$(this);WdatePicker({dateFmt:"yyyy-MM-dd HH:mm:ss",onpicked:function(e){var n=t.closest("tr"),r=n.find(".js-list-starttime").val(),i=n.find(".js-list-endtime").val();if(!y(r,i)){var s={alertType:0,alertTit:"\u63d0\u793a",alertMsg:"\u505c\u6b62\u65f6\u95f4\u5fc5\u987b\u665a\u4e8e\u542f\u52a8\u65f6\u95f4\u3002"};layer.alert(s.alertMsg,s.alertType,s.alertTit)}else v({msg:"\u60a8\u786e\u5b9a\u8981\u4fee\u6539\u6295\u653e\u65f6\u95f4\uff1f",yesFunction:function(){var e=n.attr("rowid"),t={adid:e,starttime:r,stoptime:i};$.ajax({url:"/ad_fix?op=edittime",data:t}).done(function(e){e?(alert("\u4fdd\u5b58\u6210\u529f\u3002"),location.reload()):(alert("\u4fdd\u5b58\u5931\u8d25\u3002"),location.reload())})},noFunction:function(){location.reload()}})}})}),$(".js-newad-form-starttime, .js-newad-form-stoptime").on("focus",function(){var e=$(this);WdatePicker({dateFmt:"yyyy-MM-dd HH:mm",onpicked:function(){e.blur()}})})})});define("page/admin_data",[],function(e,t,n){$(function(){function e(e){var t=0,n=e.length,r=[],i=[],s=[],o="";e.length||(o='<tr><td colspan="11">\u6682\u65e0\u6570\u636e</td></tr>');for(t=0;t<n-1;t++){o+="<tr>";var u=e[t].date.toString();r.unshift(u.slice(-2)),i.unshift(e[t].loginer_1.replace(/,/g,"")),s.unshift(e[t].paysum_1.replace(/,/g,"")),o+="<td>"+u.slice(-4,-2)+"/"+u.slice(-2)+"</td>",o+="<td>"+e[t].paysum_1+"</td>",o+="<td>"+e[t].payer_1+"</td>",o+="<td>"+e[t].newerPayer+"</td>",o+="<td>"+e[t].arpu+"</td>",o+="<td>"+e[t].payRate+"</td>",o+="<td>"+e[t].loginer_1+"</td>",o+="<td>"+e[t].newer+"</td>",o+="<td>"+e[t].refluxer+"</td>",o+="<td>"+e[t].stabler+"</td>",o+="<td>"+e[t].newerLossRate+"</td>",o+="</tr>"}$(".overview-data-panel tbody").html(o);var a={tooltip:{trigger:"axis"},legend:{data:["\u6536\u5165","\u6d3b\u8dc3"]},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",boundaryGap:!1,data:r}],yAxis:[{type:"value",name:"\u91d1\u989d",axisLabel:{formatter:"{value}\uffe5"}},{type:"value",name:"\u4eba\u6570",axisLabel:{formatter:"{value}\u4eba"}}],series:[{name:"\u6d3b\u8dc3",type:"line",data:i,yAxisIndex:1},{name:"\u6536\u5165",type:"line",data:s}]},f=echarts.init($(".charts")[0]);f.setOption(a)}$("[data-toggle]").on("click",function(){var e=$(this).data("toggle");$(this).addClass("active").siblings().removeClass("active"),$("."+e).addClass("active").siblings().removeClass("active")}),$("#tab_data").addClass("active"),$("#allgames").on("change",function(){var e=this.value;e&&(console.log(e),$.ajax({url:"/online_games",type:"post",data:{appkey:"dtszj"},dataType:"json",success:function(e){if(!e){layer.msg("\u7cfb\u7edf\u7e41\u5fd9\uff01",1,8);return}if(!e.errno){if(e.data&&e.data.zones.length==0){layer.msg("\u6b64\u6e38\u620f\u6682\u672a\u6dfb\u52a0\u533a\u670d\uff01",1,8);return}var t,n,r=e.data.zones;str='<option value="">\u8bf7\u9009\u62e9\u533a\u670d</option>';for(t=0,n=r.length;t<n;t++)str+="<option value='"+r[t].id+"'>"+r[t].name+"</option>";$("#arealist").html(str)}else layer.msg(e.errmsg,1,8)}}))}),$(".Wdate").on("focus",function(){WdatePicker({dateFmt:"yyyy-MM-dd"})}),$("#search").click(function(){var t=$("#allgames").val(),n=$("#arealist").val(),r=$(".stime").val().replace(/-/g,""),i=$(".etime").val().replace(/-/g,"");if(!t||!n||!r||!i)return layer.msg("\u8bf7\u9009\u62e9\u6e38\u620f\uff0c\u6e38\u620f\u533a\u670d\uff0c\u4ee5\u53ca\u8981\u67e5\u8be2\u65f6\u95f4\u6bb5\uff01",1,8),!1;var s="/overview_daily";return $.ajax({url:s,type:"post",data:{bdate:r,edate:i,gkey:t,skey:n},dataType:"json",success:function(t){t&&!t.errno?e(t.data||{}):layer.msg("\u83b7\u53d6\u6570\u636e\u5931\u8d25\uff01",1,8)}}),!1})})});define("page/appdetail",[],function(e,t,n){$(function(){$(".listtab a").on("click",function(){var e=$(this).data("tabpage");return $(this).parent().addClass("tab-selected").siblings().removeClass("tab-selected"),$("."+e).show().siblings().hide(),!1}),$(".gene-loc").on("click",function(){var e={area_id:$(this).data("skey"),appkey:$(this).data("appkey"),qid:$(this).data("qid")};return $.ajax({url:"/debug_interface",type:"get",data:e,dataType:"json"}).done(function(t){if(t.error)return layer.msg("\u670d\u52a1\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01",1,8),!1;e=t.data.login,login_url=e[0].result.apiPath+e[0].result.apiArgs,window.open(login_url)}),!1}),$("#parse_btn").on("click",function(){var e=$("#parse_domain_form").serialize(),t=$("#parse_domain").val(),n=$("#parse_ip").val();return t===""||n===""?(layer.msg("\u8bf7\u6b63\u786e\u586b\u5199\u57df\u540d\u4fe1\u606f\uff01",1,0),!1):!/^\d+$/.test(t)||t<0||t>9999?(layer.msg("\u8bf7\u6b63\u786e\u586b\u5199\u57df\u540d\u4fe1\u606f\uff01",1,0),!1):($.ajax({url:"/parsedns",type:"post",data:e,dataType:"json",success:function(e){if(!e)return layer.msg("\u670d\u52a1\u5668\u51fa\u9519\uff01",1,8),!1;var t=1,n;switch(e.errno){case 0:n="\u89e3\u6790\u6210\u529f\uff01",type=9;break;case-109:n="\u57df\u540d\u89e3\u6790\u5df2\u7ecf\u5b58\u5728\uff0c\u8bf7\u8054\u7cfb\u57df\u540d\u5373\u7cfb\u4eba\u5458\u89e3\u51b3\uff01",type=8;break;case-99:n="\u8bf7\u6c42\u5931\u8d25\uff01",type=8;break;default:n="\u7cfb\u7edf\u7e41\u5fd9\uff01",type=1}layer.msg(n,t,type)},fail:function(){}}),!1)}),$(".appdetail-list-stateon, .appdetail-list-stateoff").on("click",function(){var e=$(this).data("state"),t={skey:$(this).data("skey"),appkey:$(this).data("appkey"),state:e?0:1},n=this;return console.log(t),$.ajax({type:"post",url:"/update_zone_status",data:t,dataType:"json",success:function(e){console.log(e),e&&!e.errno?(t.state?$(n).addClass("appdetail-list-stateon").removeClass("appdetail-list-stateoff"):$(n).addClass("appdetail-list-stateoff").removeClass("appdetail-list-stateon"),$(n).data("state",t.state)):layer.msg("\u64cd\u4f5c\u5931\u8d25, \u8bf7\u91cd\u8bd5\uff01",1,8)}}),!1})})});define("page/appdetail_edit",["module/modal.js"],function(e,t,n){$(function(){function u(e){var t=location.href.indexOf("?"),n=location.href.substr(t+1),r=n.split("&"),i={};for(var s in r)i[r[s].split("=")[0]]=r[s].split("=")[1];return i}var t=e("module/modal.js"),n=$("#add_zone_btn"),r=$("#opentime"),i=$(".Wdate"),s=u(location.href),o="/addzone";i.on("focus",function(){WdatePicker({dateFmt:"yyyy-MM-dd HH:mm:ss"})}),s.op=="edit"&&(o="update_zone",$.ajax({type:"get",url:"/get_zone",data:s,dataType:"json",success:function(e){if(e.errno)alert("\u8bf7\u6c42\u4e0d\u5230\u6570\u636e\uff01");else{console.log(e);var t=e.data;$("input[name=opentime]").val(t.opentime),$("select[name=runstate]").val(t.rstate),$("input[name=loginenable]").each(function(){t.loginenabled==this.value?this.checked=!0:this.checked=!1}),$("input[name=payenable]").each(function(){t.payenabled==this.value?this.checked=!0:this.checked=!1})}}})),n.on("click",function(){if(!r.val())return $.layer({dialog:{type:3,msg:"\u8bf7\u9009\u62e9\u5f00\u670d\u65f6\u95f4\uff01"}}),!1;var e=$(this).closest("form").serialize();return e+="&skey="+s.skey,console.log(e),$.ajax({url:o,type:"post",data:e,dataType:"json",success:function(e){console.log(e),t.process(e,{eText:"\u64cd\u4f5c\u5931\u8d25\uff01",sText:"\u64cd\u4f5c\u6210\u529f\uff01"})}}),!1})})});define("page/appinfo/appinfo_agreement",["module/upload.js","module/modal.js","module/detectAdobeReader","page/appinfo/appinfo_common.js"],function(e,t,n){$(function(){function i(e){n.process(e,{eText:"\u7b7e\u7f72\u5408\u540c\u5931\u8d25\uff01",sText:"\u7b7e\u7f72\u5408\u540c\u6210\u529f\uff01",sFunc:function(){var e=$(".btn-wrap").closest(".step2");$(".btn-wrap").remove(),e.append('<div class="upload-wrap"><div class="upload-file" id="uploadAgreement">\u56de\u4f20\u76d6\u7ae0\u626b\u63cf\u4ef6</div><div class="upload-desc"><a id="uploadBefore" target="_blank">\u5c1a\u672a\u56de\u4f20\uff0c</a><span>\u8bf7\u4e0a\u4f20pdf\u683c\u5f0f(\u5c0f\u4e8e8M)\u7684\u5df2\u52a0\u76d6\u516c\u7ae0\u7684\u5408\u540c\u6587\u6863\u626b\u63cf\u4ef6</span></div></div><div class="download-wrap"><a class="btn" href="/contract_download?type=unsigned&appkey='+appinfo.appkey+' "target="_blank">\u4e0b\u8f7d\u5408\u540c</a>'+'<a class="btn" href="/contract_preview?type=unsigned&appkey='+appinfo.appkey+'" target="_blank">\u53bb\u65b0\u9875\u9762\u67e5\u770b</a>'+"</div>"),s()}})}function s(){var e=t.uploader({pick:"#uploadAgreement",server:"/contract_upload",formData:{appkey:appinfo.appkey}});e.on("uploadSuccess",function(e,t){if(t.errno==0){var n="/contract_download?type=signed&appkey="+appinfo.appkey;$("#uploadBefore").attr({href:n,target:"_blank"}).text("\u67e5\u770b\u56de\u4f20\u7684\u626b\u63cf\u4ef6"),layer.msg("\u4e0a\u4f20\u6210\u529f\uff01",1,9)}else layer.msg(t.errmsg)}),e.on("uploadComplete",function(t,n){e.removeFile(t)})}function o(){var e=r.detect();if(e){var t=$(".step2 .info-list"),n='<iframe id="showpdf" style="display: none; width:100%; height:300px;" frameborder="0"></iframe>',i='<p id="loading" style="height: 300px;width: 100%;line-height: 300px;text-align: center;">\u6b63\u5728\u52a0\u8f7d\u5408\u540c\u5185\u5bb9...</p>';t.html(n+i),$("#showpdf").attr("src","/contract_generate?appkey="+t.data("key")),$("#showpdf")[0].onload=function(){$("#showpdf").show(),$("#loading").remove()}}else alert("\u4f60\u53ef\u80fd\u8fd8\u6ca1\u6709\u5b89\u88c5pdf\u9605\u8bfb\u5668\uff0c\u4e3a\u4e86\u65b9\u4fbf\u4f60\u67e5\u770bpdf\u6587\u6863\uff0c\u8bf7\u4e0b\u8f7d\uff01"),window.open("http://get.adobe.com/cn/reader/")}function u(){var e=r.detect();if(e){var t=$(".step2 .info-list"),n='<iframe id="showpdf" style="display: none; width:100%; height:300px;" frameborder="0"></iframe>',i='<p id="loading" style="height: 300px;width: 100%;line-height: 300px;text-align: center;">\u6b63\u5728\u52a0\u8f7d\u5408\u540c\u5185\u5bb9...</p>';t.html(n+i),$("#showpdf").attr("src","/contract_preview?type=unsigned&appkey="+t.data("key")),$("#showpdf")[0].onload=function(){$("#showpdf").show(),$("#loading").remove()}}else alert("\u4f60\u53ef\u80fd\u8fd8\u6ca1\u6709\u5b89\u88c5pdf\u9605\u8bfb\u5668\uff0c\u4e3a\u4e86\u65b9\u4fbf\u4f60\u67e5\u770bpdf\u6587\u6863\uff0c\u8bf7\u4e0b\u8f7d\uff01"),window.open("http://get.adobe.com/cn/reader/")}function a(){$("#panel_li_5").addClass("active"),$("#panel_li_5").data("status")!=0&&(u(),s()),$(".nextstep").on("click",function(){$(".step1").hide().next().show(),o()}),$(".prevstep").on("click",function(){$(".step1").show().next().hide()}),$("#qs_agreement").on("click",function(){$.ajax({type:"post",url:"/contract_signment?appkey="+$(".step2 .info-list").data("key"),dataType:"json",success:i})})}var t=e("module/upload.js"),n=e("module/modal.js"),r=e("module/detectAdobeReader");e("page/appinfo/appinfo_common.js"),a()})});define("page/appinfo/appinfo_basicinfo",["module/modal.js","module/ext_validator.js","page/appinfo/appinfo_common.js"],function(e,t,n){$(function(){function n(){var e=$("#firstletter")[0];e.value=e.value.slice(-1),/[a-zA-Z]/.test(e.value)?e.value=e.value.toLocaleUpperCase():e.value=""}function r(){var e=$("#firstletter");e.on("input",n),e.on("change",n),$("#panel_li_1").addClass("active"),$("#basic_form").validate({rules:{appname:"required","abstract":"required",firstletter:"required",type_1:"required",type_2:"required",graphic:"required",terminaltype:"required",yuanbao:{required:!0,digits:!0,max:1e5,min:1}}}),$(".help").hover(function(){$("#"+$(this).data("to")).show()},function(){$("#"+$(this).data("to")).hide()})}var t=e("module/modal.js");e("module/ext_validator.js"),e("page/appinfo/appinfo_common.js"),r()})});define("page/appinfo/appinfo_common",["module/modal.js"],function(e,t,n){function s(){$.ajax({url:"/apply_audit",type:"post",data:"appkey="+appinfo.appkey,dataType:"json"}).done(function(e){r.process(e,{eText:"\u4e0a\u7ebf\u5931\u8d25\uff01",sText:"\u4e0a\u7ebf\u6210\u529f\uff01",sFunc:function(){location.href="/app_detail?appkey="+appinfo.appkey}})})}function o(){var e=!0;return $(".app-sidebar").find("i.status ").each(function(t,n){if($(this).closest("li").data("status")!=2)return e=!1,!1}),e}var r=e("module/modal.js"),i=$("#applyOnline");!i.data("state")&&o()&&(console.log(1),i.removeClass("disabled").prop("disabled",!1),i.on("click",s))});define("page/appinfo/appinfo_interface_debug",["module/modal.js","page/appinfo/appinfo_common.js"],function(e,t,n){$(function(){function i(){return $.ajax({type:"post",url:"/post_interface",data:$("#interface_form").serialize(),dataType:"json"}).done(function(e){if(!e)return layer.msg("\u7cfb\u7edf\u7e41\u5fd9\uff01",1,8),!1;var t=1,n="\u7cfb\u7edf\u7e41\u5fd9\uff01",r=8;e.errno?e.errno==30003&&(n="\u63a5\u53e3\u8c03\u8bd5\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u8c03\u8bd5\uff01"):(n="\u4fdd\u5b58\u6210\u529f\uff01",r=9),layer.msg(n,t,r)}),!1}function s(e){var t=$("#area_id_input").val();if(!u(t))return layer.msg("\u533a\u670d\u8f93\u5165\u4e0d\u5408\u6cd5",1,0),!1;$.ajax({type:"post",url:e.url,data:$("#interface_form").serialize(),dataType:"json"}).done(o)}function o(e){if(!e)return layer.msg("\u7cfb\u7edf\u7e41\u5fd9\uff01",1,8),!1;var t,r,i,s={login:{order:0,cn:"\u767b\u9646\u63a5\u53e3"},checkuser:{order:1,cn:"\u89d2\u8272\u5224\u65ad\u63a5\u53e3"},exchange:{order:2,cn:"\u5143\u5b9d\u5151\u6362\u63a5\u53e3"}},o=$(".interface-input-items").find(".form-info"),u={interfaceType:"<h2>{{interfaceType}}</h2>",testType:"<h3>{{testType}}</h3>",systemTest:"<p><span>\u7cfb\u7edf\u6d4b\u8bd5</span>\uff1a{{systemTest}}</p>",failReason:"<p><span>\u5931\u8d25\u539f\u56e0</span>\uff1a{{failReason}}</p>",md5:"<p><span>\u7b7e\u540d\u89c4\u5219\uff1a</span>{{md5}}</p>",requestUrl:"<p><span>\u8bf7\u6c42\u5730\u5740</span>\uff1a{{requestUrl}}</p>",result:"<p><span>\u8fd4\u56de\u7ed3\u679c</span>\uff1a{{result}}</p>"};if(!e.errno){data=e.data;var a="",f=!0,l=!1;for(t in data){i=!0,a+=u.interfaceType.replace("{{interfaceType}}",s[t].cn);for(r in data[t]){var c=data[t][r].result;c.testPass||(i=!1,f=!1),l||(n=c.apiPath+c.apiArgs,l=!0),a+=u.testType.replace("{{testType}}",data[t][r].testType)+u.systemTest.replace("{{systemTest}}",c.testPass)+u.failReason.replace("{{failReason}}",c.failReason)+u.md5.replace("{{md5}}",c.signRule)+u.requestUrl.replace("{{requestUrl}}",c.apiPath+c.apiArgs)+u.result.replace("{{result}}",c.curlResult)}i?o.eq(s[t].order).addClass("ok").removeClass("error"):o.eq(s[t].order).addClass("error").removeClass("ok")}f&&layer.msg("\u8c03\u8bd5\u6210\u529f\uff01",1,9),$.layer({type:1,title:"\u8c03\u8bd5\u7ed3\u679c",area:["auto","auto"],page:{html:'<div class="debugResult-modal">'+a+"</div>"}})}else layer.msg(e.msg,1,8)}function u(e){return!!(e&&/^\d+$/.test(e)&&e>0&&e<1e4)}function a(){var e=$.layer({type:1,title:!1,area:["auto","auto"],border:[0],closeBtn:[0,!1],page:{html:$("#modal-tpl").html()}});return $(".modal .close-btn").on("click",function(){layer.close(e)}),$("#parse_btn").on("click",function(){var e=$("#parse_domain_form").serialize(),t=$("#parse_domain").val(),n=$("#parse_ip").val();return t===""||n===""?(layer.msg("\u8bf7\u9009\u62e9\u57df\u540d\u4fe1\u606f\uff01",1,0),!1):($.ajax({url:"/parsedns",type:"post",data:e,dataType:"json",success:f}),!1)}),!1}function f(e){if(!e)return layer.msg("\u7cfb\u7edf\u7e41\u5fd9\uff01",1,0),!1;var t='<div class="parse-result {{state}}"></div><div class="parse-result-txt">{{text}}</div>';t=t.replace("{{state}}",e.errno?"errno":"success").replace("{{text}}",e.errmsg),$("#domain-modal").find(".modal-body").html(t);if(!e.errno){var n=e.data.registResult;$("#app_secret").text(n.client_secret),$("#redirect_uri").text(n.redirect_uri)}}function l(){$("#panel_li_3").addClass("active"),$("#interface_submit").on("click",i),$("#interface_debug").on("click",function(){return s({url:"/debug_interface"}),!1}),$("#login_game").on("click",function(){window.open(n)}),$("#parse_domain_modal").on("click",a)}var t=e("module/modal.js");e("page/appinfo/appinfo_common.js");var n,r="http://www.baidu.com";l()})});define("page/appinfo/appinfo_upload_licences",["module/upload.js","page/appinfo/appinfo_common.js"],function(e,t,n){$(function(){function n(){var e=$(".agent-form-item"),n=$(".register-code"),r={};$("#panel_li_4").addClass("active"),$("#copyright, #licence, #approval_document,#document_filing, #agent").each(function(e,n){r[n.id]=t.uploader({pick:"#"+n.id,innerHTML:"\u4e0a\u4f20"}),r[n.id].on("uploadSuccess",function(e,t){var r=t,i=$("#"+n.id).closest(".form-item");i.find("span.status").text("\u5df2\u4e0a\u4f20").addClass("uploaded"),i.find(".img_view").addClass("uploaded")[0].href=r.data.URL[0],$('input[name="'+n.id+'"]').val(r.data.URL[0])})}),$('[name="ownership"]').on("change",function(){this.value==1?e.show():e.hide()}),$('[name="copyright_type"]').on("change",function(){this.value==0?n.show():n.hide()}),$(".form-item .introduce").hover(function(){$(this).next().slideDown()},function(){$(this).next().hide()}),$("#licencesForm").validate({submitHandler:function(e){$.ajax({type:"post",url:$(e).attr("action"),data:$(e).serialize(),dataType:"json",success:function(e){e.errno?layer.msg("\u4fdd\u5b58\u5931\u8d25\uff0c\u8bf7\u68c0\u6d4b\u5b57\u6bb5\u662f\u5426\u586b\u5199\u5b8c\u6574\uff01",1,8):layer.msg("\u4fdd\u5b58\u6210\u529f\uff01",1,9)}})}})}var t=e("module/upload.js");e("page/appinfo/appinfo_common.js"),n()})});define("page/appinfo/appinfo_uploadpic",["module/upload.js","module/modal.js","module/ext_validator.js","page/appinfo/appinfo_common.js"],function(e,t,n){$(function(){function i(){$("#panel_li_2").addClass("active"),$(".form-item .introduce").hover(function(){$(this).next().slideDown()},function(){$(this).next().hide()}),$("#appImageForm").validate({}),$("#16x16,#72x72,#119x86,#226x164,#1000x600").each(function(e,n){r[n.id]=t.uploader({pick:"#"+n.id}),r[n.id].on("uploadSuccess",function(e,t){var r=t,i=$("#"+n.id).closest(".form-item");i.find("span.status").text("\u5df2\u4e0a\u4f20").addClass("uploaded"),i.find(".img_view").addClass("uploaded")[0].href=r.data.URL[0],$('input[name="img_'+n.id+'"]').val(r.data.URL[0])})})}var t=e("module/upload.js"),n=e("module/modal.js"),r={};e("module/ext_validator.js"),e("page/appinfo/appinfo_common.js"),i()})});define("page/applist",["module/modal.js"],function(e,t,n){$(function(){var t=e("module/modal.js"),n=$("#tab_myApps"),r=$(".app_submit");n.addClass("active"),r.on("click",function(){var e=this;return $.ajax({url:"/apply_audit",type:"post",data:"appkey="+$(this).data("key"),dataType:"json",success:function(n){t.process(n,{eText:"\u4e0a\u7ebf\u5931\u8d25,\u786e\u8ba4\u6e38\u620f\u8d44\u6599\u662f\u5426\u5b8c\u6574\u5e76\u901a\u8fc7\u5ba1\u6838\uff01",sText:"\u4e0a\u7ebf\u6210\u529f\uff01",sFunc:function(){var t=$(".app-img-wrap").attr("href");t.replace("app_detail","gameinfo"),$(".app-img-wrap").attr("href",t),$(e).before('<span class="btn disabled">\u5df2\u7ecf\u4e0a\u7ebf</span>').remove()}})}}),!1})})});define("page/createapp",["common/login.js","module/modal.js","module/ext_validator.js"],function(e,t,n){$(function(){function o(){var e=r[0];e.value=e.value.slice(-1),/[a-zA-Z]/.test(e.value)?e.value=e.value.toLocaleUpperCase():e.value=""}var t=e("common/login.js"),n=e("module/modal.js");e("module/ext_validator.js");var r=$("#firstletter"),i=$("#appname"),s=$("#create_app_form");r.on("input",o),r.on("change",o),$(".help").hover(function(){console.log($(this).data("to")),$("#"+$(this).data("to")).show()},function(){$("#"+$(this).data("to")).hide()}),i.on("change",function(){var e=this.value,t=this;e&&$.ajax({url:"/checkgame",type:"POST",data:{appname:e},dataType:"json",success:function(e){n.process(e,{sLayer:!1,eText:"\u6e38\u620f\u540d\u5df2\u7ecf\u5b58\u5728\uff01",eFunc:function(){t.value=""}})}})}),s.validate({rules:{appname:"required",firstletter:"required",graphic:"required",type_2:"required",type_1:"required",terminaltype:"required"},submitHandler:function(e){$.ajax({type:"post",url:"/post_appinfo",data:$(e).serialize(),dataType:"json",success:function(e){n.process(e,{eText:"\u521b\u5efa\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01",sText:"\u521b\u5efa\u6e38\u620f\u6210\u529f\uff01",sFunc:function(){location.href="/gameinfo?op=basicinfo&appkey="+e.data}})}})}})})});define("page/data/getOption",[],function(e,t,n){var r={bar:{tooltip:{trigger:"axis"},legend:{data:[]},toolbox:{show:!1},calculable:!0,xAxis:[{type:"category",boundaryGap:!1,data:["\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d","\u5468\u65e5"]}],yAxis:[{type:"value",axisLabel:{formatter:"{value} \u00b0C"}}],series:[{name:"\u6700\u9ad8\u6c14\u6e29",type:"line",data:[11,11,15,13,12,13,10],markPoint:{data:[{type:"max",name:"\u6700\u5927\u503c"},{type:"min",name:"\u6700\u5c0f\u503c"}]},markLine:{data:[{type:"average",name:"\u5e73\u5747\u503c"}]}},{name:"\u6700\u4f4e\u6c14\u6e29",type:"line",data:[1,-2,2,5,3,2,0],markPoint:{data:[{name:"\u5468\u6700\u4f4e",value:-2,xAxis:1,yAxis:-1.5}]},markLine:{data:[{type:"average",name:"\u5e73\u5747\u503c"}]}}]}};t.getOption=function(e,t){}});define("page/data/realtime_data",[],function(e,t,n){function u(){function i(e){return e||""}var e=globalData,t="",n,r;if(e&&!e.errno){r=e.data;for(n in r)r.hasOwnProperty(n)&&(t+=["<tr><td>",i(n),"</td><td>",i(r[n].charge_amount),"</td><td>",i(r[n].charge_user),"</td><td>",i(r[n].login_user),"</td><td>",i(r[n].new_user),"</td></tr>"].join(""))}return t}function a(){$(".J-do_query").on("click",function(){})}function f(){var e=$(".J-multi_key");s.on("click",function(){var t=$(this);s.removeClass("btn-active").addClass("btn-normal"),t.removeClass("btn-normal").addClass("btn-active"),e.val(t.data("value"))})}function l(e){var t=!gd.data.errono&&gd.data.data,n,i={time:[],money:[],rmbUser:[],onlineUser:[],newUser:[]};for(n in t)i.time.push(+n>9?n+":00":"0"+n+":00"),i.money.push(+t[n].charge_amount),i.rmbUser.push(+t[n].charge_user),i.onlineUser.push(+t[n].login_user),i.newUser.push(+t[n].new_user);o.xAxis[0].data=i.time,o.series[0].data=i.money,s.on("click",function(){var e=$(this).data("value");o.series[0].data=i[e],echarts.init(r.get(0)).setOption(o)})}var r=$(".J-bar_chart"),i=echarts.init(r.get(0)),s=$(".J-multi_key_to"),o={tooltip:{trigger:"axis"},legend:{data:["\u4eca\u5929"],x:"left",y:"bottom"},grid:{borderWidth:0},toolbox:{show:!1},calculable:!0,xAxis:[{axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1},type:"category",boundaryGap:!1,data:["01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00"]}],yAxis:[{axisLine:{show:!1},type:"value"}],series:[{name:"\u4eca\u5929",type:"line",symbol:"none",itemStyle:{normal:{areaStyle:{type:"default"}}},stack:"\u603b\u91cf",data:[0,111,333,444,500,666,777,888,999,1e3,1111,1222,1333,1444,1500,3e3,2222,1111]}]};t.init=function(){l(),i.setOption(o),f()}}),$(function(){$("#query").click(function(){$("#isexcel").val(0),$("#form").submit()}),$("#excel").click(function(){$("#isexcel").val(1),$("#form").submit()})});define("page/data/retention_analysis",[],function(e,t,n){function y(){$("ul input",o).each(function(){var e=$(this),t=e.val(),n=0,r=gd.skeys&&gd.skeys.length||0;if(gd.skeys)for(;n<r;n++)gd.skeys[n]==t&&e.prop("checked",!0).trigger("change")})}function b(){function e(){var e="",n;s=0;for(n in i)e+=["<span>",n,"</span>"].join(""),s++;u.empty().html(e),e?a.show():a.hide(),t()}function t(){o.find(".J-to_choose").not(":checked").prop("disabled",s>=10)}function n(){o.find(".J-to_choose").prop("checked",!1),i={},e()}r.on("change",function(){var e=$.trim($(this).val());a.trigger("click"),$(".J-pop_tbox",o).html($(".J-"+e,m).clone()),v.addClass(!e&&"is-disabled").removeClass(!!e&&"is-disabled")}),c.on("click",function(){var e=$(this);c.removeClass("btn-val-actived").addClass("btn-val-normal"),e.addClass("btn-val-actived").removeClass("btn-val-normal"),$("tbody").hide(),$("."+e.data("value")).show()}),v.on("click",function(){var e=$(this).is(".is-disabled");e||o.show()}),o.find(".J-confirm, .J-close").on("click",function(){o.hide()}),o.on("click",function(e){e.stopPropagation()}),$(document).on("click",function(e){var t=$(e.target);!t.is(".J-choose_server")&&o.hide()}),a.on("click",function(){n(),l.add(f).prop("checked",!1)}),o.on("change",".J-to_choose",function(t){var n=$(t.target),r,s;n.is("input:checked")?(r=n.val(),s=n.parent("label").text(),i[s]=r):(r=n.val(),s=n.parent("label").text(),delete i[s]),e()}),f.on("change",function(){var e=this;l.prop("checked",!1),n(),o.find(".J-to_choose").each(function(t){return t<5&&$(this).prop("checked",$(e).is(":checked")).change()})}),l.on("change",function(){var e=this;f.prop("checked",!1),n(),o.find(".J-to_choose").each(function(t){return t<10&&$(this).prop("checked",$(e).is(":checked")).change()})}),o.find(".J-to_choose").each(function(e){return e<10&&$(this).on("change",function(){$(this).is(":checked")||(e<5&&f.add(l).prop("checked",!1),e>5&&l.prop("checked",!1))})})}var r=$(".J-choose_gname"),i={},s=0,o=$(".J-pop_pannel"),u=$(".J-chosen_items"),a=$(".J-btn_delete"),f=$(".J-choose_latest5"),l=$(".J-choose_latest10"),c=$(".J-valtype_to"),h=$(".J-val_type"),p=$(".J-submit"),d=$(".J-form"),v=$(".J-choose_server"),m=$(".J-pannel_uls").remove(),g;t.init=function(){b(),r.trigger("change"),setTimeout(y,200)}}),$(function(){$("#query").click(function(){$("#isexcel").val(0),$("#form").submit()}),$("#excel").click(function(){$("#isexcel").val(1),$("#form").submit()})});define("page/finance",["module/modal.js","module/upload.js","module/ext_validator.js","module/selectArea.js"],function(e,t,n){$(function(){var t=e("module/modal.js"),n=e("module/upload.js"),r=e("module/ext_validator.js"),i=e("module/selectArea.js"),s=$("#tab_finance"),o=$("#finance_form"),u=$("#bank"),a=$("#bank2"),f=$("#account_state"),l=$(".page-state-txt");s.addClass("active").parent().removeClass("hide"),i.init({container:".select-area"}),o.validate({rules:{name:"required",bank:"required",bank_name:"required",bank_city:"required",bank_account:"required",tax_number:"required",tax_url:"required",contacts:"required",email:{required:!0,email:!0},mobile:{required:!0,mobile:!0}}}),u.on("change",function(){$(this).val()==9999?a.closest(".form-item").slideDown():a.closest(".form-item").slideUp()}),function(){var t=["\u4fe1\u606f\u5ba1\u6838\u4e2d\u3002","\u8d22\u52a1\u4fe1\u606f\u5df2\u901a\u8fc7\u5ba1\u6838\uff0c\u5982\u9700\u4fee\u6539\u8bf7\u53d1\u9001\u90ae\u4ef6\u5230opengame@360.cn\u3002","\u4fe1\u606f\u672a\u901a\u8fc7\u5ba1\u6838\uff0c\u8bf7\u586b\u5199\u6b63\u786e\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u91cd\u65b0\u63d0\u4ea4\u5ba1\u6838\u3002","\u4fe1\u606f\u5df2\u7b7e\u8ba2\u5408\u540c\uff0c\u4e0d\u53ef\u4fee\u6539\u3002"],r=f.data("state");l.text(t[r]);if(r==2||r==0){var i=n.uploader({pick:"#upload_tax"});i.on("uploadSuccess",function(e,t){var n=t;$("#tax_img").attr("src",n.data.URL[0]),$("#tax_url_input").val(n.data.URL[0]).trigger("change").trigger("blur").trigger("focusout")}),r==2&&$("#finance_form").find(":radio").addClass("disabled").prop("disabled",!0)}else $("#upload_tax").remove(),$(".form-action").remove(),$("#finance_form").find("input,select,radio,checkbox,button").addClass("disabled").prop("disabled",!0)}()})});define("page/index",[],function(e,t,n){$(function(){$("#index").addClass("nav_active").siblings().removeClass("nav_active"),$(".slider").zzmSlider({interval:5e3,fadeTime:1e3}),$(".go-admin-center").on("click",function(){return QHPass.when.signIn(function(){window.location.href="/manage"}),!1}),$("#close-code-btn").on("click",function(){var e=$(this).parent();e.animate({left:-e.innerWidth()},function(){$(this).remove()})}),$("#close-act-btn").on("click",function(){var e=$(this).parent();e.animate({right:-e.innerWidth()},function(){$(this).remove()})})})});define("page/pay_detail",[],function(e,t,n){$(function(){$.ajax({url:"/devide_money?op=detail&id="+location.hash.slice(1),dataType:"json"}).done(function(e){console.log(e);if(e&&e.errno==0){var t=$("#detailTpl").html();$(".container").prepend(_.template(t)({data:e.data}))}})})});define("page/pay_manage",[],function(e,t,n){$(function(){function e(e,t){$.ajax(e).done(t)}function t(e){console.log(e);if(e&&e.errno==0){var t=_.template($("#recordsTpl").html())({data:e.data});$("#records_table tbody").html(t)}else $("#records_table tbody").html('<tr><td colspan="9">\u6682\u65e0\u6570\u636e</td></tr>')}function n(){return e({type:"post",url:"/devide_money?op=manage",data:$("#condition_form").serialize()},t),!1}function r(){var e={id:$(this).data("id"),state:$(this).data("state")},t=this;$.ajax({type:"post",url:"/devide_money?op=changeState",data:e}).done(function(e){e&&e.errno==0?($(t).prev().text("\u5f00\u7968\u5b8c\u6bd5"),$(t).remove()):alert(e.errmsg)})}function i(){$("#pay_manage").addClass("active").parent().show(),$("#search_btn").on("click",n),$("#records_table").on("click",".detail-btn",r),e({url:"/devide_money?op=manage"},t),$(".Wdate").on("focus",function(){WdatePicker({dateFmt:"yyyy-MM-dd"})})}i()})});define("page/pay_mySettlement",[],function(e,t,n){$(function(){function e(){var e=0,t=0;$("#records_table").find("input[type=checkbox]").each(function(n,r){r.checked&&(t++,e+=parseFloat($(this).closest("tr").find(".divid_money").text()))}),$("#select_count").text(t),$("#select_money").text(e.toFixed(2))}function t(){$("#pay_self").addClass("active").parent().show(),$(".Wdate").on("focus",function(){WdatePicker({dateFmt:"yyyyMM"})}),$.ajax({url:"/devide_money?op=list",dataType:"json"}).done(function(e){var t=$("#recordsTpl").html();e&&e.errno==0?e=e.data:e={},$("#table_wrap").html(_.template(t)({data:e}))})}function n(){var e=!0;return $("#records_table").find("input[type=checkbox]:checked").each(function(t,n){if($(n).closest("tr").find("input").data("state")!=1e3)return e=!1,!1}),e}function r(){if(!n())return layer.msg("\u53ea\u80fd\u9009\u62e9\u672a\u7ed3\u7b97\u7684\u7ed3\u7b97\u5355\uff01",1,8),!1;var e=i();if(!e.orderList)return layer.msg("\u8bf7\u9009\u62e9\u672a\u7ed3\u7b97\u7684\u7ed3\u7b97\u5355\uff01",1,8),!1;var t=$.layer({type:1,title:"\u7ed3\u7b97\u5904\u7406",area:["640px","500px"],page:{html:$("#modalTpl").html()}});$("#orders").text(e.orderList),$("#total_money").text(parseFloat(e.sumMoney).toFixed(2)),$("#cancel").on("click",function(){layer.close(t)}),$("#submit").on("click",function(){var n=$("#invoice_select").val(),r=$("#confirm_invoice")[0].checked;if(!n){layer.msg("\u8bf7\u9009\u62e9\u53d1\u7968\u9879\u76ee");return}if(!r){layer.msg("\u8bf7\u786e\u8ba4\u5df2\u9605\u8bfb\u5f00\u7968\u987b\u77e5");return}var i={divideIds:e.orderList,cash:$("#to_cash").val(),cloud:$("#to_cloud").val(),ad:$("#to_ad").val(),invoice:$('input[name="invoice"]:checked').val(),invoiceItem:$("#invoice_select").val()};$.ajax({type:"post",url:"/devide_money?op=calculate",data:i}).done(function(e){e&&e.errno==0?(layer.close(t),layer.msg("\u5904\u7406\u6210\u529f\uff01",1,9,function(){location.reload()})):layer.msg(e&&e.errmsg?e.errmsg:"\u670d\u52a1\u5668\u53d1\u751f\u9519\u8bef\uff01",1,8)})}),$("#to_cloud,#to_ad").on("change",function(){var e=$("#total_money").text(),t=$("#to_cloud").val()?$("#to_cloud").val():0,n=$("#to_ad").val()?$("#to_ad").val():0,t=parseInt(t),n=parseInt(n),r;t+n>e&&(t=$ad_num=0),r=parseFloat(e)-parseFloat(t)-parseFloat(n),$("#to_cash").val(parseFloat(r).toFixed(2))})}function i(){var e={orderList:"",sumMoney:0},t=[];return $("#records_table").find("input[type=checkbox]").each(function(n,r){if(r.checked){var i=parseFloat(e.sumMoney)+parseFloat($(this).closest("tr").find(".divid_money").text());e.sumMoney=parseFloat(i).toFixed(2),t.push($(this).closest("tr").find(".divideid").text())}}),e.orderList=t.join(","),e}function s(e,t){$.ajax(e).done(t)}function o(e){if(e&&e.errno==0){var t=_.template($("#recordsTpl").html())({data:e.data});$("#table_wrap").html(t)}else layer.msg("\u6682\u65e0\u6570\u636e",1,8)}function u(){return s({type:"post",url:"/devide_money?op=list",data:$("#condition_form").serialize()},o),!1}function a(e){s({type:"post",url:"/devide_money?op=list",data:{state:e?e:""}},o)}$(document).on("click",".detail-btn",function(){var e=$(this).data("id");return $.ajax({url:"/devide_money?op=detail&id="+e,dataType:"json"}).done(function(e){if(e&&e.errno==0)var t=$("#detailTpl").html(),n=$.layer({type:1,title:"\u7ed3\u7b97\u5355\u8be6\u60c5",area:["740px","580px"],page:{html:_.template(t)({data:e.data})}})}),!1}),$(".selectAll").on("click",function(){$("#records_table").find("input[type=checkbox]").each(function(e,t){t.checked=!0}),e()}),$(".calculate").on("click",r),$("#search_btn").on("click",u),$("#remain_records").on("click",function(){a(1e3),$(this).addClass("active").siblings().removeClass("active")}),$("#all_records").on("click",function(){a(),$(this).addClass("active").siblings().removeClass("active")}),$("#table_wrap").on("change","input[type=checkbox]",function(){e()}),t()})});define("page/pay_records",[],function(e,t,n){$(function(){function e(e,t){$.ajax(e).done(t)}function t(e){console.log(e);if(e&&e.errno==0){var t=_.template($("#recordsTpl").html())({data:e.data});$(".records-wrap").html(t)}else layer.msg("\u6682\u65e0\u6570\u636e",1,8)}function n(){return e({type:"post",url:"/devide_money?op=records",data:$("#condition_form").serialize()},t),!1}$("#pay_record").addClass("active").parent().show(),$.ajax({url:"/devide_money?op=records"}).done(function(e){e&&e.errno==0?$(".records-wrap").append(_.template($("#recordsTpl").html())({data:e.data})):layer.msg("\u6682\u65e0\u6570\u636e",1,8)}),$("#search_btn").on("click",n),$(".Wdate").on("focus",function(){WdatePicker({dateFmt:"yyyy-MM-dd"})}),$(document).on("click",".order-id",function(){var e=$(this).data("id");return $.ajax({url:"/devide_money?op=detail&id="+e,dataType:"json"}).done(function(e){if(e&&e.errno==0)var t=$("#detailTpl").html(),n=$.layer({type:1,title:"\u7ed3\u7b97\u5355\u8be6\u60c5",area:["740px","580px"],page:{html:_.template(t)({data:e.data})}})}),!1})})});define("page/reg_developer",["module/modal.js","module/upload.js","module/ext_validator.js","module/selectArea.js"],function(e,t,n){$(function(){var t=e("module/modal.js"),n=e("module/upload.js"),r=e("module/ext_validator.js"),i=e("module/selectArea.js"),s=$("#dev_reg_form"),o=$("#agreement"),u=$("#dev_reg_form-btn");i.init({container:".select-area"}),$("#pass_text").hover(function(){$(".imginfo").slideDown()},function(){$(".imginfo").slideUp()});var a=n.uploader({pick:"#licence"});a.on("uploadSuccess",function(e,t){var n=t;$("#preview_licence")[0].src=n.data.URL[0],$("#preview_licence").parent().show(),$("#licence_img_url").val(n.data.URL[0]),$("#licence_img_url").trigger("change").trigger("blur").trigger("focusout")}),o[0].checked&&u.removeAttr("disabled").removeClass("disabled"),o.on("change",function(){var e=this.checked;e?u.removeAttr("disabled").removeClass("disabled"):u.attr("disabled",!0).addClass("disabled")}),s.validate({rules:{name:"required",licence:"required",licence_number:{required:!0,rangelength:[15,15]},reg_address:"required",address:"required",contacts:"required",email:{required:!0,email:!0},mobile:{required:!0,mobile:!0},phone:{required:!0,phone:!0},address_city:"required",reg_city:"required"},messages:{licence:'<i class="error"></i>\u8bf7\u4e0a\u4f20\u8425\u4e1a\u6267\u7167'},submitHandler:function(e){$.ajax({type:"post",url:"/post_cpinfo",data:$(e).serialize(),dataType:"json",success:function(e){t.process(e,{eText:"\u6ce8\u518c\u5931\u8d25,\u8bf7\u786e\u8ba4\u4fe1\u606f\u5df2\u586b\u5199\u5b8c\u6574\uff01",sText:"\u6ce8\u518c\u6210\u529f\uff01",sFunc:function(){location.href="/manage"}})},fail:function(){layer.msg("\u7f51\u7edc\u51fa\u9519\uff0c\u8bf7\u91cd\u8bd5\uff01",1,type)}})}})})});